let queue=Promise.resolve();function send_queued_requests(e,t,a,n,o){return queue=queue.catch(()=>{}).then(()=>build_payload(e,t,a,n,o)),queue}function build_payload(e,t,a,n,o){return new Promise((s,i)=>{const r=format_datetime(t.event_timestamp),d=format_datetime(t.page_data.page_timestamp),l=parse_user_agent();t.event_date=r.date,t.event_data.user_agent=l.ua,t.event_data.browser_name=l.browser.name,t.event_data.browser_language=l.browser.language,t.event_data.browser_version=l.browser.version,t.event_data.device_type=l.device.type||"desktop",t.event_data.device_vendor=l.device.vendor,t.event_data.device_model=l.device.model,t.event_data.os_name=l.os.name,t.event_data.os_version=l.os.version,t.event_data.screen_size=window.screen.width+"x"+window.screen.height,t.event_data.viewport_size=window.innerWidth+"x"+window.innerHeight,t.page_date=d.date,t.page_data.page_language=document.documentElement.lang,o&&"page_view"==t.event_data.event_type?fetch(window.location.href,{method:"HEAD"}).then(o=>{t.page_data.page_status_code=o.status,send_requests(e,t,a,n,s,i)}):send_requests(e,t,a,n,s,i)})}function send_requests(e,t,a,n,o,s){n&&console.log(t.event_name,">","SENDING REQUEST"),fetch(e,{method:"POST",credentials:"include",mode:"cors",keepalive:!0,body:JSON.stringify(t)}).then(e=>e.json()).then(e=>{200===e.status_code?(n&&console.log(t.event_name,">","  ðŸ‘‰ Payload data: ",e.data),n&&console.log(t.event_name,">","REQUEST STATUS"),n&&console.log(t.event_name,">"," ",e.response),a.gtmOnSuccess(),o(e.data)):(n&&console.log(t.event_name,">  ",e.response),n&&console.log(t.event_name,">","REQUEST STATUS"),n&&console.log(t.event_name,">","  ðŸ”´ Request refused"),a.gtmOnSuccess(),o(e.data))}).catch(e=>{n&&console.log(t.event_name,">","  ðŸ”´",e),n&&console.log(t.event_name,">","REQUEST STATUS"),n&&console.log(t.event_name,">","  ðŸ”´ Request not sent successfully"),a.gtmOnSuccess(),s(e)})}function format_datetime(e){const t=new Date(e),a=t.getUTCFullYear(),n=String(t.getUTCMonth()+1).padStart(2,"0"),o=String(t.getUTCDate()).padStart(2,"0"),s=String(t.getUTCHours()).padStart(2,"0"),i=String(t.getUTCMinutes()).padStart(2,"0"),r=String(t.getUTCSeconds()).padStart(2,"0"),d=String(t.getUTCMilliseconds()).padStart(3,"0");return{date:`${a}-${n}-${o}`,date_time:`${a}-${n}-${o}T${s}:${i}:${r}`,date_time_millis:`${a}-${n}-${o}T${s}:${i}:${r}.${d}`,date_time_micros:`${a}-${n}-${o}T${s}:${i}:${r}.${d}000`,year:a,month:n,day:o,hours:s,minutes:i,seconds:r,milliseconds:`.${d}`,microseconds:`.${d}000`}}const parse_user_agent=function(){var e=(new UAParser).getResult();return e.browser.language=navigator.language,e};function get_channel_grouping(e,t){const a={search_engine:new RegExp("360\\.cn|alice|aol|ar\\.search\\.yahoo\\.com|ask|bing|google|yahoo|yandex|baidu|ecosia|duckduckgo|sogou|naver|seznam","i"),social:new RegExp("facebook|twitter|instagram|pinterest|linkedin|reddit|vk\\.com|tiktok|snapchat|tumblr|wechat|whatsapp","i"),shopping:new RegExp("amazon|ebay|etsy|shopify|stripe|walmart|mercadolibre|alibaba|naver\\.shopping","i"),video:new RegExp("youtube|vimeo|netflix|twitch|dailymotion|hulu|disneyplus|wistia|youku","i"),ai:new RegExp("chatgpt|gemini|bard|claude|alexa|siri|assistant|\\.ai([/]|$)","i"),email:new RegExp("email|e-mail|newsletter|mailchimp|sendgrid|sparkpost","i")};return e?"direct"===e?"direct":"tagassistant.google.com"===e?"gtm_debugger":a.search_engine.test(e)?t?"paid_search_engine":"organic_search_engine":a.social.test(e)?t?"paid_social":"organic_social":a.shopping.test(e)?t?"paid_shopping":"organic_shopping":a.video.test(e)?t?"paid_video":"organic_video":a.ai.test(e)?"ai":a.email.test(e)?t?"email":"undefined":t?t?"affiliate":"undefined":"referral":"internal_traffic"}function set_cross_domain_listener(e,t,a,n){const o=e,s=t;document.addEventListener("click",function(e){var t=e.target.closest("a");if(t&&t.getAttribute("href")){var i=t.getAttribute("href"),r=new URL(i);if(!/^(#|javascript:|tel:|mailto:)/.test(r.href)){var d=r.hostname;const c=s.some(e=>d===e||d.endsWith(`.${e}`)),g=d.includes(window.location.hostname);var l=t.getAttribute("target");const _=get_last_consent_values(),u=1==_.analytics_storage||null==_.analytics_storage;let m=null;if(!c||g)return;if(c&&!(!a||u))return;e.preventDefault(),c&&"_blank"===l&&(m=window.open("about:blank","_blank")),get_user_data(o,{event_name:"get_user_data",event_origin:"Website"}).then(e=>{n&&console.log("cross-domain > NAMELESS ANALYTICS"),n&&console.log("cross-domain > ASK USER DATA");const t=e.data;n&&console.log("cross-domain >   ðŸ‘‰ User data: ",t),n&&console.log("cross-domain > CHECK USER DATA");const a=t.client_id,o=t.session_id;a&&"undefined"!=a&&o&&"undefined"!=o?(n&&console.log("cross-domain >   ðŸŸ¢ Valid user data. Cross-domain URL link decoration will be applied"),r.searchParams.set("na_id",o)):n&&console.log("cross-domain > ",e.response),n&&console.log("cross-domain >   ðŸ‘‰ Redirect to: "+r.href),m?m.location.href=r.href:window.location.href=r.href}).catch(e=>{n&&console.log("cross-domain > NAMELESS ANALYTICS"),n&&console.log("cross-domain > ASK USER DATA"),console.log("cross-domain >   ðŸ”´ Error while fetch user data: "+e),n&&console.log("cross-domain >   ðŸ‘‰ Redirect to: "+i),m?m.location.href=i:window.location.href=i})}}})}function get_last_consent_values(){if("undefined"!=typeof google_tag_data&&google_tag_data){const e=google_tag_data.ics.usedDefault,t=google_tag_data.ics.usedUpdate,a=google_tag_data.ics.entries;return{consent_type:e?e&&!t?"Default":"Update":"Consent mode not present",ad_user_data:e?a.ad_user_data.update||a.ad_user_data.default:null,ad_personalization:e?a.ad_personalization.update||a.ad_personalization.default:null,ad_storage:e?a.ad_storage.update||a.ad_storage.default:null,analytics_storage:e?a.analytics_storage.update||a.analytics_storage.default:null,functionality_storage:e?a.functionality_storage.update||a.functionality_storage.default:null,personalization_storage:e?a.personalization_storage.update||a.personalization_storage.default:null,security_storage:e?a.security_storage.update||a.security_storage.default:null}}}function get_user_data(e,t){if("undefined"!==e.split("/")[2].split(".")[1])return fetch(e,{method:"POST",credentials:"include",mode:"cors",keepalive:!0,body:JSON.stringify(t)}).then(e=>e.json()).then(e=>e)}